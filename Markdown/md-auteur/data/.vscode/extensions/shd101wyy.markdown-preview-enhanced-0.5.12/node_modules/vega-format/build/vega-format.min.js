!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-format"),require("vega-time"),require("vega-util"),require("d3-time-format")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-format","vega-time","vega-util","d3-time-format"],t):t((e=e||self).vega={},e.d3,e.d3,e.vega,e.vega,e.d3)}(this,(function(e,t,r,a,i,n){"use strict";function o(e){const t={};return r=>t[r]||(t[r]=e(r))}function c(e){const a=o(e.format),i=e.formatPrefix;return{format:a,formatPrefix:i,formatFloat(e){var t,i,n=r.formatSpecifier(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return t=a(n),i=a(".1f")(1)[1],e=>{var r,a,n=t(e),o=n.indexOf(i);if(o<0)return n;for(a=(r=function(e,t){var r,a=e.lastIndexOf("e");if(a>0)return a;for(a=e.length;--a>t;)if((r=e.charCodeAt(a))>=48&&r<=57)return a+1}(n,o))<n.length?n.slice(r):"";--r>o;)if("0"!==n[r]){++r;break}return n.slice(0,r)+a}}return a(n)},formatSpan(e,n,o,c){c=r.formatSpecifier(null==c?",f":c);const u=t.tickStep(e,n,o),f=Math.max(Math.abs(e),Math.abs(n));let s;if(null==c.precision)switch(c.type){case"s":return isNaN(s=r.precisionPrefix(u,f))||(c.precision=s),i(c,f);case"":case"e":case"g":case"p":case"r":isNaN(s=r.precisionRound(u,f))||(c.precision=s-("e"===c.type));break;case"f":case"%":isNaN(s=r.precisionFixed(u))||(c.precision=s-2*("%"===c.type))}return a(c)}}}let u,f;function s(){return u=c({format:r.format,formatPrefix:r.formatPrefix})}function m(e){return c(r.formatLocale(e))}function l(e){return arguments.length?u=m(e):u}function p(e,t,r){r=r||{},i.isObject(r)||i.error("Invalid time multi-format specifier: "+r);const n=t(a.SECONDS),o=t(a.MINUTES),c=t(a.HOURS),u=t(a.DATE),f=t(a.WEEK),s=t(a.MONTH),m=t(a.QUARTER),l=t(a.YEAR),p=e(r[a.MILLISECONDS]||".%L"),d=e(r[a.SECONDS]||":%S"),S=e(r[a.MINUTES]||"%I:%M"),g=e(r[a.HOURS]||"%I %p"),E=e(r[a.DATE]||r[a.DAY]||"%a %d"),F=e(r[a.WEEK]||"%b %d"),v=e(r[a.MONTH]||"%B"),x=e(r[a.QUARTER]||"%B"),L=e(r[a.YEAR]||"%Y");return e=>(n(e)<e?p:o(e)<e?d:c(e)<e?S:u(e)<e?g:s(e)<e?f(e)<e?E:F:l(e)<e?m(e)<e?v:x:L)(e)}function d(e){const t=o(e.format),r=o(e.utcFormat);return{timeFormat:e=>i.isString(e)?t(e):p(t,a.timeInterval,e),utcFormat:e=>i.isString(e)?r(e):p(r,a.utcInterval,e),timeParse:o(e.parse),utcParse:o(e.utcParse)}}function S(){return f=d({format:n.timeFormat,parse:n.timeParse,utcFormat:n.utcFormat,utcParse:n.utcParse})}function g(e){return d(n.timeFormatLocale(e))}function E(e){return arguments.length?f=g(e):f}s(),S();const F=(e,t)=>i.extend({},e,t);function v(e,t){const r=arguments.length;return r&&2!==r&&i.error("defaultLocale expects either zero or two arguments."),r?F(l(e),E(t)):F(l(),E())}e.defaultLocale=v,e.locale=function(e,t){const r=e?m(e):l(),a=t?g(t):E();return F(r,a)},e.numberFormatDefaultLocale=l,e.numberFormatLocale=m,e.resetDefaultLocale=function(){return s(),S(),v()},e.resetNumberFormatDefaultLocale=s,e.resetTimeFormatDefaultLocale=S,e.timeFormatDefaultLocale=E,e.timeFormatLocale=g,Object.defineProperty(e,"__esModule",{value:!0})}));